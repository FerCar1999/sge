function get_data_callback_personal(){$.ajax({data:{limit:itemsPorPagina,offset:desde,busqueda:$.trim($("input#buscar_personal").val()),estado:ver_estado_personal},type:"POST",url:url_listar_personal}).done(function(a,b,c){var d=a.lista;$(".table").html(""),0==pagina&&creaPaginador(a.cantidad),$.each(d,function(a,b){"Activo"==ver_estado_personal?$('<tr id="+elem.id+"><td>'+b.codigo+"</td><td>"+b.nombre+"</td><td>"+b.apellido+"</td><td>"+b.correo+'</td><td><a onclick="ver_personal('+b.id+",'"+b.nombre+"','"+b.apellido+"','"+b.codigo+"','"+b.correo+"','"+b.foto+"',"+b.permiso+')" class="btn-floating green" ><i  class="material-icons">edit</i></a> <a onclick="eliminar_personal('+b.id+",'"+b.nombre+"','"+b.apellido+'\')" class="btn-floating green"><i class="material-icons">delete</i></a> <a onclick="asistencias_diferidas('+b.id+",'"+b.nombre+"','"+b.apellido+'\')" class="btn-floating green"><i class="material-icons">alarm</i></a></td></tr>').appendTo($(".table")):$('<tr id="+elem.id+"><td>'+b.codigo+"</td><td>"+b.nombre+"</td><td>"+b.apellido+"</td><td>"+b.correo+'</td><td><a onclick="activar_personal('+b.id+",'"+b.nombre+"','"+b.apellido+'\')" class="btn-floating green" ><i  class="material-icons">autorenew</i></a></td></tr>').appendTo($(".table"))})}).fail(function(a,b,c){alert("Error al realizar la petición dame".textError)})}function readURL(a){if(a.files&&a.files[0]){var b=new FileReader;b.onload=function(a){$("#img_personal").attr("src",a.target.result),$("#img_personal_mod").attr("src",a.target.result)},b.readAsDataURL(a.files[0])}}function ver_personal(a,b,c,d,e,f,g){pk_personal=a,foto_antigua=f,$(".agregar_personal").hide(),$(".modificar_personal").show(),$("label").addClass("active"),$("#mod_nombre").val(b),$("#mod_apellido").val(c),$("#mod_correo").val(e),$("#mod_codigo").val(d),$("#selectPermisoMod").find('option[value="'+g+'"]').prop("selected",!0),$("#selectPermisoMod").material_select(),$("#img_personal_mod").attr("src",f)}function asistencias_diferidas(a,b,c){pk_personal=a,$(".modal").modal(),$(".modal").modal("open"),$("#profesor").text(b+" "+c),$.ajaxSetup({async:!1}),$.ajax({data:{id:a},type:"POST",url:url_asistencias_diferidas}).done(function(a,b,c){var d=a.lista;$("#select_materias").html(""),$.each(d,function(a,b){$("#select_materias").append($("<option>",{value:b.id,text:b.nombre})),$("select").material_select()})}).fail(function(a,b,c){}),$.ajax({data:{id:a},type:"POST",url:url_asistencias_diferidas_historial}).done(function(a,b,c){var d=a.lista;$.each(d,function(a,b){$("#select_materias").find('option[value="'+b.id+'"]').prop("selected",!0),$("#hora").val(b.hora),$("#horalbl").addClass("active"),$("select").material_select(),1==siempre?($("#check_siempre").val(!0),check_siempre=!0):($("#check_siempre").val(!1),check_siempre=!1)})}).fail(function(a,b,c){})}function guardar_asistencia_diferida(){$.ajaxSetup({async:!1});for(var a=0;a<$("#select_materias").val().length;a++)$.post(url_guardar_asistencias_diferidas,{id:pk_personal,id_horario:$("#select_materias").val()[a],hora:$("#hora").val(),siempre:check_siempre},function(a){});swal("Éxito","Asistencias guardadas.","info")}function eliminar_personal(a,b,c){pk_personal=a,$(".agregar_personal").hide(),$(".modificar_personal").hide(),$(".eliminar_personal").show(),$("#confirmacion").text("¿Desea desactivar a "+b+" "+c+"?"),estado_personal="Inactivo"}function activar_personal(a,b,c){pk_personal=a,$(".activar_personal").show(),$(".eliminar_personal").hide(),$(".modificar_personal").hide(),$(".agregar_personal").hide(),estado_personal="Activo",$("#confirmacion_activar").text("¿Desea activar a "+b+" "+c+"?")}function personal_init(){cargaPagina(0),$(".eliminar_personal").hide(),$(".modificar_personal").hide(),$(".activar_personal").hide(),$(".agregar_personal").show()}function limpiarCampos(){$("#nombre").val(""),$("#apellido").val(""),$("#correo").val(""),$("#codigo").val(""),$("#clave").val(""),$("#claveR").val(""),$("#buscar_personal").val(""),$("label").removeClass("active"),$("input").removeClass("valid"),$("input").removeClass("invalid"),$("#img_personal").attr("src","/media/img/user_default.png"),$("#mod_nombre").val(""),$("#mod_apellido").val(""),$("#mod_correo").val(""),$("#mod_codigo").val(""),$("#img_personal_mod").attr("src","/media/img/user_default.png")}var url_listar_personal="/privado/php/personal/personal_listar.php",url_personal="/privado/php/personal/personal.php",url_permisos_listar="/privado/php/personal/permisosPersonal.php",url_asistencias_diferidas="/privado/php/asistencias_diferidas/obtener_asignaturas.php",url_asistencias_diferidas_historial="/privado/php/asistencias_diferidas/cargar_perfi.php",url_guardar_asistencias_diferidas="/privado/php/asistencias_diferidas/guardar_asistencias.php",url_eliminar_personal="/privado/php/personal/eliminar_personal.php",pk_personal,estado_personal="Inactivo",foto_antigua,ver_estado_personal="Activo";check_siempre="",$("#buscar_personal").keyup(function(){personal_init()}),$("#ver_personal_activo").click(function(a){"Activo"!=ver_estado_personal&&(ver_estado_personal="Activo",set_callback(get_data_callback_personal),personal_init())}),$("#ver_personal_inactivo").click(function(a){"Inactivo"!=ver_estado_personal&&(ver_estado_personal="Inactivo",set_callback(get_data_callback_personal),personal_init())}),$(document).ready(function(){paginador=$(".pagination");var a=10,b=3;init_paginator(paginador,a,b),set_callback(get_data_callback_personal),personal_init(),$("select").material_select(),$("#formPersonal").on("submit",function(a){a.preventDefault();var b=new FormData(this);b.append("nombre",$("#nombre").val()),b.append("apellido",$("#apellido").val()),b.append("correo",$("#correo").val()),b.append("codigo",$("#codigo").val()),b.append("clave",$("#clave").val()),b.append("claveR",$("#claveR").val()),b.append("permiso",$("#selectPermiso").val()),$.ajax({url:url_personal,type:"POST",data:b,contentType:!1,processData:!1,success:function(a){switch(a){case"agregado":swal("Éxito","Personal agregado.","success"),personal_init(),limpiarCampos();break;case"camposFalta":swal("Error",a,"error");break;default:swal("Error",a,"error")}}})}),$("#formPersonalMod").on("submit",function(a){a.preventDefault();var b=new FormData(this);b.append("id",pk_personal),b.append("nombre",$("#mod_nombre").val()),b.append("apellido",$("#mod_apellido").val()),b.append("codigo",$("#mod_codigo").val()),b.append("correo",$("#mod_correo").val()),b.append("url_foto",foto_antigua),b.append("permiso",$("#selectPermisoMod").val()),$.ajax({url:url_personal,type:"POST",data:b,contentType:!1,processData:!1,success:function(a){Materialize.toast(a,5e3,"rounded"),personal_init(),limpiarCampos()}})})}),$("#agregar_personal").click(function(a){$("#formPersonal").submit()}),$("#modificar_personal").click(function(a){$("#formPersonalMod").submit()}),$("#eliminar_personal").click(function(a){$.post(url_eliminar_personal,{id:pk_personal,estado:estado_personal},function(a){personal_init(),Materialize.toast(a,3e3,"rounded")})}),$("#activar_personal").click(function(a){$.post(url_eliminar_personal,{id:pk_personal,estado:estado_personal},function(a){personal_init(),swal(a)})}),$("#cancelar_mod").click(function(a){$(".agregar_personal").show(),limpiarCampos(),$(".modificar_personal").hide(),$(".eliminar_personal").hide()}),$("#cancelar_eliminar").click(function(a){$(".agregar_personal").show(),$(".modificar_personal").hide(),$(".eliminar_personal").hide()}),$("#cancelar_activar").click(function(a){$(".agregar_personal").show(),$(".modificar_personal").hide(),$(".eliminar_personal").hide()}),$("#fotoPersonal").change(function(){readURL(this)}),$("#fotoPersonalMod").change(function(){readURL(this)}),$("#check_siempre").change(function(){$(this).is(":checked")&&(swal("Éxito","El docente podrá realizar la asistencia en cualquier momento.","success"),$(this).attr("checked",!0)),$("#check_siempre").val($(this).is(":checked")),check_siempre=$("#check_siempre").prop("checked")});