function enfermeria_init(){$("#selecAlumno").show(),$("#asignarObservacion").hide(),$("#modObservacion").hide(),$(".observacionEnfermeria").hide()}function enfermeria_select(){$("#nombreEnf").text($("#alumno").val().substring(9,$("#alumno").val().length)),$("#carnetEnf").text($("#alumno").val().substring(0,8)),$("#fotoEnf").attr("src",autocompleteAlumnos[$("#alumno").val()]),$(".observacionEnfermeria").show(),$("#asignarObservacion").show(),$("#selecAlumno").hide(),alumno=$("#carnetEnf").text()}function obtenerAlumnos(){return $.ajaxSetup({async:!1}),$.ajax({type:"POST",url:url_listar_alumnos_guia,data:{},dataType:"json",success:function(valores){var resp=eval(valores);return $.each(resp,function(a,b){var c=b.alumno,d=b.foto;autocompleteAlumnos[c]=d}),!1}}),!1}function modificarVisita(a){$.post(url_asignar_visita,{observacion:$("#observacion_text").val(),modificar:a},function(a){switch(a){case"success":Materialize.toast("Llegada tarde asignada.",3e3,"rounded");break;case"error":swal("Error al procesar petición.","error");break;default:Materialize.toast(a,3e3,"rounded"),cargar_historial_enfermeria(),limpiar(),enfermeria_init()}})}function eliminar_visita(a){$.post(url_eliminar_visita,{id:a,token:$("#dpToken").val()},function(a){switch(a){case"success":Materialize.toast("Llegada tarde asignada.",3e3,"rounded");break;case"error":swal("Error al procesar petición.","error");break;default:Materialize.toast(a,3e3,"rounded"),cargar_historial_enfermeria(),limpiar(),enfermeria_init()}})}function asignarVisita(a){$.post(url_asignar_visita,{pk_alumno:a,observacion:$("#observacion_text").val(),token:$("#dpToken").val(),modificar:0},function(a){switch(a){case"success":Materialize.toast("Llegada tarde asignada.",3e3,"rounded");break;case"error":swal("Error al procesar petición.","error");break;default:Materialize.toast(a,3e3,"rounded"),cargar_historial_enfermeria()}})}function cargar_historial_enfermeria(){$.ajax({data:{},type:"POST",url:url_historial_enfermeria}).done(function(a,b,c){var d=a.lista;$(".lienfermeria").html(""),$.each(d,function(a,b){$("<tr><td>"+b.nombre+"</td><td>"+b.especialidad+"</td><td>"+b.fecha+'</td><td><a href="#!" class="btn-floating tooltipped" data-position="left" data-delay="50" data-tooltip="Quitar código" onclick="eliminar_visita('+b.id+')"><i class="material-icons">highlight_off</i></a> <a href="#!" class="btn-floating tooltipped" data-position="left" data-delay="50" data-tooltip="Quitar código" onclick="ver_visita('+b.id+",'"+b.alumno+"','"+b.observacion+'\')"><i class="material-icons">edit</i></a></td><tr>').appendTo($(".lienfermeria"))})}).fail(function(a,b,c){$(".lienfermeria").html("")})}function limpiar(){$("input.autocomplete").val(""),$("#observacion_text").val("")}function ver_visita(a,b,c){pk_enfermeria=a,$("#modObservacion").show(),$("input.autocomplete").val(b),$("#observacion_text").val(c),$("label").addClass("active"),enfermeria_select(),$("#asignarObservacion").hide()}var url_listar_alumnos_guia="/privado/php/enfermeria/listarAlumnos.php",url_asignar_visita="/privado/php/enfermeria/enfermeria.php",url_historial_enfermeria="/privado/php/enfermeria/historialEnfermeria.php",url_eliminar_visita="/privado/php/enfermeria/eliminarVisita.php",autocompleteAlumnos={},alumno,pk_enfermeria;$(document).ready(function(){obtenerAlumnos(),$("input.autocomplete").autocomplete({data:autocompleteAlumnos}),enfermeria_init(),cargar_historial_enfermeria()}),$("#selecAlumno").click(function(){enfermeria_select()}),$("#asignarObservacion").click(function(){asignarVisita(alumno)}),$("#modObservacion").click(function(){modificarVisita(pk_enfermeria)}),$("#cancelarButton").click(enfermeria_init);